<FileChoosePopup>:
    title: "Choose a .CSV File"
    size_hint: .9, .9
    auto_dismiss: False

    BoxLayout:
        orientation: "vertical"
        FileChooser:
            id: filechooser
            multiselect: True
            FileChooserIconLayout


        BoxLayout:
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}
            spacing: 20
            Button:
                text: "Cancel"
                on_release: root.dismiss()
            Button:
                text: "Load"
                on_release: root.load(filechooser.selection)
                id: ldbtn
                disabled: True if filechooser.selection==[] else False

<FileSavePopup>:
    title: "Save Kinematic Data"
    size_hint: .9, .9
    auto_dismiss: False

    BoxLayout:
        orientation: "vertical"
        FileChooser:
            id: filechooser_save
            multiselect: False
            dirselect: True
            filters: ['']
            FileChooserIconLayout:
                on_touch_down: root.load_filepath_to_view(filechooser_save.selection)

        BoxLayout:
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}
            spacing: 20

            TextInput:
                id: filename_save
                height: 30
                multiline: False

            Button:
                text: "Cancel"
                on_release: root.dismiss()
            Button:
                text: "Save"
                on_release:
                    app.save_kinematics(root.ids.filename_save.text,filechooser_save.selection)
                    root.dismiss()
                id: save_button
                disabled: True if filechooser_save.selection==[] else False

<FileImportPopup>:
    title: "Import Kinematic Data"
    size_hint: .9, .9
    auto_dismiss: False

    BoxLayout:
        orientation: "vertical"
        FileChooser:
            id: filechooser_save
            multiselect: False
            dirselect: True
            filters: ['']
            FileChooserIconLayout

        BoxLayout:
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}
            spacing: 20

            Button:
                text: "Cancel"
                on_release: root.dismiss()
            Button:
                text: "Import"
                on_release:
                    app.import_kinematics(filechooser_save.selection)
                    root.dismiss()
                id: save_button
                disabled: True if filechooser_save.selection==[] else False

<ModelFits>:
    do_default_tab: False

    TabbedPanelItem:
        text: 'Import'
        background_color: (1, .5, 0, 1)
        background_normal: ''
        StackLayout:
            orientation: 'lr-tb'
            size_hint_y: None
            height: 30
            spacing: 5
            Label:
                text: 'Modelfit Images (.fits files)'
                size_hint_x: 1
            Label:
                text: ''
                size_hint_x: 0.2
            Button:
                text: 'Choose File'
                size_hint_x: 0.2
                on_press: root.open_popup()
            TextInput:
                id: get_file
                readonly: True
                size_hint_x: 0.4
            Label:
                text: ''
                size_hint_x: 0.2
    TabbedPanelItem:
        text: 'Kinematics'
        background_color: (1, .5, 0, 1)
        background_normal: ''
        BoxLayout:
            id: main_box
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                padding: 50
                BoxLayout:
                    id: box_top_left
                    orientation: 'vertical'
                    ScrollView:
                        size: self.size
                        size_hint_y: 0.9
                        id: scroll_component
                        GridLayout:
                            size_hint_y: None
                            cols: 1
                            id: component_list
                            height: self.minimum_height
                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint_y: 0.1
                        Button:
                            text:"Add"
                            on_release:app.add_component()
                        Button:
                            text:"Remove"
                            on_release: app.remove_component()
                        Button:
                            text:"Reset Index (not implemented)"
                        Button:
                            text:"Set Core"
                            on_release:app.set_core_component()
                BoxLayout:
                    id: box_top_center
                    orientation: "vertical"
                    BoxLayout:
                        size_hint_y: 0.1
                        Button:
                            size_hint_x: 0.2
                            text:"Export Data"
                            on_release:
                                root.open_save_dialog()
                        Button:
                            size_hint_x: 0.2
                            text:"Import Data"
                            on_release:
                                root.open_import_dialog()
                        TextInput:
                            size_hint_x: 0.2
                            id: redshift
                            text: "0.00"
                            on_text: app.update_redshift()
                            multiline: False
                        Button:
                            size_hint_x: 0.4
                            text:"Get Redshift from NED"
                            on_release: app.get_redshift()

                    BoxLayout:
                        orientation: "vertical"
                        size_hint_y: 0.7
                        BoxLayout:
                            size_hint_y: 0.1
                            orientation: "horizontal"
                            Label:
                                text: "Component ID"
                            Label:
                                text: "Speed (mas/yr)"
                            Label:
                                text: "⁠β_app (c)"
                            Label:
                                text: "D_crit"
                        ScrollView:
                            size: self.size
                            size_hint_y: 0.9
                            id: scroll_kinematic
                            GridLayout:
                                size_hint_y: None
                                cols: 1
                                id: kinematic_list
                                height: self.minimum_height
                    BoxLayout:
                        size_hint_y: 0.1
                        Button:
                            text:"Home"
                            on_release: app.home_plot()
                        ToggleButton:
                            group:'touch_mode'
                            text:"Zoom Mode"
                            on_release:
                                app.set_touch_mode('zoombox')
                                self.state='down'
                        ToggleButton:
                            group:'touch_mode'
                            text:"Pick Component"
                            on_release:
                                app.set_touch_mode('pointselect')
                                self.state='down'
                BoxLayout:
                    orientation:"vertical"
                    id: box_top_right
                    MatplotFigure:
                        id: kinematic_plot
                    BoxLayout:
                        size_hint_y: 0.1
                        ToggleButton:
                            group:'kinematic_select'
                            id: kinematic_choose
                            text:"Kinematic"
                            state: "down"
                            on_release:
                                app.update_kinematic_plot()
                                self.state='down'
                        ToggleButton:
                            group:'kinematic_select'
                            text:"Flux Density"
                            id: flux_choose
                            on_release:
                                app.update_kinematic_plot()
                                self.state='down'
                        ToggleButton:
                            group:'kinematic_select'
                            text:"Brightness Temperature"
                            id: tb_choose
                            on_release:
                                app.update_kinematic_plot()
                                self.state='down'
            ScrollView:
                id: figure_scroll
                do_scroll_y: False
                do_scroll_x: True
                size: self.size
                scroll_type: ['bars','content']
                padding: 50
                GridLayout:
                    size_hint_x: None
                    rows: 1
                    id: figures
                    spacing: 50
                    width: self.minimum_width





